# OSATE2 代码结构分析

## 1. 项目整体结构

OSATE2采用**多模块单体架构**，共包含约**148个子目录/模块**。

```
osate2/
├── core/              # 核心模块（40个子项目）
├── analyses/          # 分析模块（20个子项目）
├── alisa/             # ALISA工作台（27个子项目）
├── emv2/              # 错误模型扩展（15个子项目）
├── ba/                # 行为附件（8个子项目）
├── ge/                # 图形编辑器（16个子项目）
├── examples/          # 示例工程（3个子项目）
├── releng/            # 发布工程（8个子项目）
├── tools/             # 工具集（3个子项目）
├── setup/             # 开发环境配置
├── pom.xml            # Maven根配置
└── README.md          # 项目说明
```

## 2. 核心模块 (core/)

核心模块包含AADL语言支持和基础功能，是整个项目的基石。

### 2.1 AADL元模型

| 模块 | 描述 |
|------|------|
| `org.osate.aadl2` | AADL2核心API和元模型 |
| `org.osate.aadl2.metamodel` | Ecore元模型定义 |
| `org.osate.aadl2.modelsupport` | 模型支持工具库 |
| `org.osate.aadl2.contrib` | 标准属性集贡献 |

### 2.2 语言支持（Xtext）

| 模块 | 描述 |
|------|------|
| `org.osate.xtext.aadl2` | AADL语法定义（Xtext） |
| `org.osate.xtext.aadl2.ui` | AADL编辑器UI |
| `org.osate.xtext.aadl2.properties` | 属性语言支持 |
| `org.osate.xtext.aadl2.properties.ui` | 属性编辑器UI |

### 2.3 实例化与运行时

| 模块 | 描述 |
|------|------|
| `org.osate.aadl2.instantiation` | 模型实例化引擎 |
| `org.osate.aadl2.instance.textual` | 实例文本表示 |
| `org.osate.results` | 分析结果模型 |

### 2.4 基础设施

| 模块 | 描述 |
|------|------|
| `org.osate.core` | 核心插件与扩展点 |
| `org.osate.ui` | UI框架 |
| `org.osate.workspace` | 工作空间管理 |
| `org.osate.slicer` | 模型切片工具 |
| `org.jgrapht` | 图论库（JGraphT 1.5.1） |

### 2.5 验证框架

| 模块 | 描述 |
|------|------|
| `org.osate.resolute` | Resolute断言评估 |

## 3. 分析模块 (analyses/)

分析模块提供各种AADL模型分析功能。

### 3.1 核心分析

| 模块 | 功能 |
|------|------|
| `org.osate.analysis.architecture` | 架构分析（连通性、依赖） |
| `org.osate.analysis.flows` | 流程分析（延迟计算） |
| `org.osate.analysis.resource.budgets` | 资源预算分析 |
| `org.osate.analysis.resource.management` | 资源管理分析 |
| `org.osate.analysis.modes` | 运行模式分析 |
| `org.osate.analysis.binpacking` | 二进制打包分析 |

### 3.2 工具与支持

| 模块 | 功能 |
|------|------|
| `org.osate.analysis.model` | 分析数据模型基础 |
| `org.osate.modelstats` | 模型统计工具 |
| `org.osate.modelstats.ui` | 统计可视化UI |
| `org.osate.codegen.checker` | 代码生成检查器 |

### 3.3 导入器

| 模块 | 功能 |
|------|------|
| `org.osate.importer` | AADL导入器框架 |
| `org.osate.importer.simulink` | Simulink模型导入 |

## 4. ALISA模块 (alisa/)

ALISA (Architecture Led Integrated System Assurance) 提供需求规范和验证保证功能。

### 4.1 核心语言

| 模块 | 描述 |
|------|------|
| `org.osate.alisa.common` | 通用语言支持 |
| `org.osate.reqspec` | 需求规范语言 |
| `org.osate.verify` | 验证计划语言 |
| `org.osate.assure` | 保证工程语言 |
| `org.osate.categories` | 分类管理 |
| `org.osate.organization` | 组织结构管理 |

### 4.2 工作台

| 模块 | 描述 |
|------|------|
| `org.osate.alisa.workbench` | ALISA主工作台 |
| `org.osate.alisa.workbench.ui` | 工作台UI |
| `org.osate.alisa.contribution` | 插件贡献 |
| `org.osate.alisa.help` | 在线帮助 |

### 4.3 UI模块

每个核心语言模块都有对应的UI模块：
- `org.osate.alisa.common.ui`
- `org.osate.reqspec.ui`
- `org.osate.verify.ui`
- `org.osate.assure.ui`
- `org.osate.categories.ui`
- `org.osate.organization.ui`

## 5. 错误模型模块 (emv2/)

EMV2 (Error Model V2) 提供AADL错误建模扩展支持。

### 5.1 核心功能

| 模块 | 描述 |
|------|------|
| `org.osate.xtext.aadl2.errormodel` | EMV2语法支持（Xtext） |
| `org.osate.xtext.aadl2.errormodel.ui` | EMV2编辑器UI |
| `org.osate.aadl2.errormodel.analysis` | 错误模型分析 |
| `org.osate.aadl2.errormodel.instance` | 错误模型实例化 |
| `org.osate.aadl2.errormodel.propagationgraph` | 故障传播图 |

### 5.2 故障树

| 模块 | 描述 |
|------|------|
| `org.osate.aadl2.errormodel.faulttree` | 故障树模型 |
| `org.osate.aadl2.errormodel.faulttree.design` | 故障树设计器 |
| `org.osate.aadl2.errormodel.faulttree.edit` | 故障树编辑 |
| `org.osate.aadl2.errormodel.faulttree.generation` | 故障树生成 |

### 5.3 支持模块

| 模块 | 描述 |
|------|------|
| `org.osate.aadl2.errormodel.contrib` | 预定义贡献 |
| `org.osate.aadl2.errormodel.help` | 帮助文档 |

## 6. 行为附件模块 (ba/)

行为附件(Behavioral Annex)支持用状态机描述组件行为。

| 模块 | 描述 |
|------|------|
| `org.osate.ba` | 行为附件核心 |
| `org.osate.ba.contrib` | 标准库贡献 |
| `org.osate.ba.edit` | 编辑支持 |
| `org.osate.ba.tests` | 测试套件 |
| `org.osate.utils` | 通用工具库 |

## 7. 图形编辑器模块 (ge/)

图形编辑器提供可视化建模能力。

### 7.1 编辑器核心

| 模块 | 描述 |
|------|------|
| `org.osate.ge` | 图形编辑器主体 |
| `org.osate.ge.diagram` | 图表模型（Ecore） |
| `org.osate.ge.gef` | GEF框架集成 |
| `org.osate.ge.gef.ui` | GEF UI组件 |
| `org.osate.ge.swt` | SWT集成 |
| `org.osate.ge.doc` | 文档 |

### 7.2 扩展

| 模块 | 描述 |
|------|------|
| `org.osate.ge.ba` | 行为附件图形支持 |
| `org.osate.ge.errormodel` | 错误模型图形支持 |

## 8. 示例模块 (examples/)

包含多个教学和演示示例：

| 示例 | 描述 |
|------|------|
| ACVIP | 航空示例 |
| ACVIP_ALISA | 含ALISA的航空示例 |
| arp4761 | ARP4761标准示例 |
| continuous-safety-risk-evaluation | 持续安全风险评估 |
| resource-budget | 资源预算示例 |
| safety-tutorial | 安全教程 |
| speed-regulation | 速度调节示例 |
| stepper-motor | 步进电机示例 |

## 9. 发布工程模块 (releng/)

管理项目构建和发布。

| 模块 | 描述 |
|------|------|
| `org.osate.build.main` | 主构建配置（父POM） |
| `org.osate.build.target` | 目标平台定义 |
| `org.osate.build.repository` | P2更新站点生成 |
| `org.osate.build.product` | 产品定义 |
| `org.osate.build.coverage.report` | 覆盖率报告 |
| `osate.releng` | OSATE发布特性 |

## 10. 工具模块 (tools/)

开发辅助工具。

| 模块 | 描述 |
|------|------|
| `org.osate.propertiescodegen` | 属性代码生成器 |
| `org.osate.propertiescodegen.ui` | 代码生成UI |

## 11. 代码统计

### 11.1 文件统计

| 类型 | 数量 |
|------|------|
| Java文件 | 3,989 |
| Xtend文件 | 393 |
| Xtext语法文件 | 10 |
| Ecore模型文件 | 30+ |
| build.properties | 117 |

### 11.2 模块统计

| 类别 | 子项目数 |
|------|----------|
| 核心 (core) | 40 |
| 分析 (analyses) | 20 |
| ALISA (alisa) | 27 |
| EMV2 (emv2) | 15 |
| BA (ba) | 8 |
| GE (ge) | 16 |
| 示例 (examples) | 3 |
| 发布 (releng) | 8 |
| 工具 (tools) | 3 |
| **总计** | **~148** |

## 12. 关键文件位置

| 文件 | 路径 |
|------|------|
| 根POM | `/osate2/pom.xml` |
| 构建主配置 | `/osate2/releng/org.osate.build.main/pom.xml` |
| AADL核心元模型 | `/osate2/core/org.osate.aadl2/model/aadl2.ecore` |
| AADL语法定义 | `/osate2/core/org.osate.xtext.aadl2/src/org/osate/xtext/aadl2/Aadl2.xtext` |
| EMV2语法定义 | `/osate2/emv2/org.osate.xtext.aadl2.errormodel/src/.../ErrorModel.xtext` |

## 13. 模块依赖层次

```
┌─────────────────────────────────────────────────────────┐
│                      应用层                              │
│  Examples (示例工程)  |  Tools (工具)                    │
└─────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────┐
│                      服务层                              │
│  ALISA Workbench | Analysis | GE | EMV2 | BA            │
└─────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────┐
│                      核心层                              │
│  AADL2 Metamodel | Xtext Support | Instance Framework   │
│  Base UI | Results Model | Resolute                     │
└─────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────┐
│                      基础层                              │
│  Eclipse Platform | Xtext/Xtend | EMF/Ecore | GEF      │
│  External Libs (JGraphT, etc.)                          │
└─────────────────────────────────────────────────────────┘
```
